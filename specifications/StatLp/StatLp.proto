syntax = "proto3";
package Vodamep.StatLp;

import "google/protobuf/timestamp.proto";

option csharp_namespace = "Vodamep.StatLp.Model";

message StatLpReport {   
    Institution institution = 1;   
    google.protobuf.Timestamp from = 2;
    google.protobuf.Timestamp to = 3;
    repeated Person persons = 4; 
    repeated Stay stays = 5;
    repeated Attribute attributes = 6;
    repeated Admission admissions = 7;
    repeated Leaving leavings= 8;
}

// Einrichtung
message Institution {
    string id = 1;
    string name = 2;    
}

// Personen, für die eine Betreuung im Meldungszeitraum durchgeführt wurde
message Person {
    string id = 1;
    string family_name = 2;
    string given_name = 3;
    google.protobuf.Timestamp birthday = 4;
    Gender gender = 5;
    string country = 6;                                        // Land aus german-iso-3166.csv
}

// Aufenthalt in der Einrichtung
message Stay {

    string person_id = 1;

    google.protobuf.Timestamp from = 2;
    google.protobuf.Timestamp to = 3;
}

// Aufnahme Daten
message Admission {

    string person_id = 1;

    string last_postcode = 2;				                    // postcode und city müssen zusammen einem Wert aus der Liste postcode_cities_StatLP.csv entsprechen
    string last_city = 3;

    google.protobuf.Timestamp valid = 4;                        // Gültigkeitsdatum der Aufnahme

    AdmissionLocation housing_type_before_admission = 5;        // 11 Wohnsituation vor der Aufnahme
    string other_housing_type = 6;                              // Sonstige Lebens-/Betreuungssituation

    bool hospital_emergency = 7;                                // 12 Krankenhaus (Akut, vor der Aufnahme)
    bool aftercare_institution = 8;                             // 13 Nachsorgeeinrichtung (vor der Aufnahme)
    bool rehab_transitional_care = 9;                           // 14 Geriatrische Remobilisation (vor der Aufnahme)

    MainAttendanceRelation main_attendance_relation = 10;       // 21 Verwandtschaftsverhältnis Hauptbetreuungspers.
    MainAttendanceCloseness main_attendance_closeness = 11;     // 22 Räumliche Nähe Hauptbetreuungsperson

    repeated Service services = 12;                             // 24 Inanspruchnahme anderer Dienste

    repeated PersonalChange personal_changes = 13;              // 31 Veränderungen persönliche Situation
    string personal_change_other = 14;                          // Anderer

    repeated SocialChange social_changes = 15;                  // 32 Veränderungen nicht bewältigt, weil
    string social_change_other = 16;                            // Anderer

    HousingReason housing_reason = 17;                          // 33 Wohnraumsituations- und Ausstattungsgründe
    string housing_reason_other = 18;                           // Anderer

    bool finance_personal_contributions = 19;                   // 44 Kontinuierliche Eigenleistungen durch Angehörige bzw. Besucher

    DiagnosisGroup diagnosis_group = 20;                        // Diagnosegruppen (Neu)
}

// Aufnahme Daten
message Leaving {

    string person_id = 1;

    LeavingReason leaving_reason = 2;                      // Abgang
    DeathLocation death_location = 3;                      // Sterbefall
    DischargeLocation discharge_location = 4;              // Entlassung Wohin
    string discharge_location_other = 5;                   // Sonstige Lebens-/Betreuungssituation
    DischargeReason discharge_reason = 6;                  // Entlassung Grund
    string discharge_reason_other = 7;                     // Anderer Grund
}

// Merkmale mit Von-Datum, ab wann sie gültig sind
// Diese Merkmale können sich innerhalb der Meldung ändern
message Attribute {

    string person_id = 1;

    google.protobuf.Timestamp from = 2;
    AttributeType attribute_type = 3;
    string value = 4;                       // Gültiger Wert ist abhängig vom attribute_type
}

// Merkmal Typen
enum AttributeType {
  UNDEFINED_ATTRIBUTE = 0;
  ADMISSION_TYPE = 1;                       // 41 Aufnahmeart
  CAREALLOWANCE = 2;                        // 05 Bezieht Pflegegeld, 06 Einstufung nach Pflegegeld Gesetz
  CAREALLOWANCEARGE = 3;                    // 42 Pflegeeinstufung nach Arge
  FINANCE = 4;                              // 43 Finanzierung Selbstzahler/Sozialhilfe
}

// 33 Wohnraumsituations- und Ausstattungsgründe
enum HousingReason {
  UNDEFINED_HOUSING_REASON = 0;
  NOT_SPECIFIED = 1;                        // Keine Angabe
  BARRIERS_ENTRANCE = 2;                    // Barrieren, Hindernisse Zugang
  BARRIERS_HABITATION = 3;                  // Barrieren, Hindernisse Wohnung
  BATHROOM_NOT_HANDICAPPED_ACCESSIBLE = 4;  // Bad WC nicht behindertengerecht
  HEATING_HABITATION = 5;                   // Beheizung der Wohnung
  OTHER_HR = 6;                             // Anderer
}

// 32 Veränderungen nicht bewältigt, weil
enum SocialChange {
  UNDEFINED_SOCIAL_CHANGE = 0;
  NO_RELATIVE_CARER = 1;                    // Keine angehörige Pflegeperson
  MISSING_MEALS = 2;                        // Fehlende Mahlzeiten
  NO_ADEQUATE_OVERSIGHT = 3;                // Keine ausreichende Beaufsichtigung
  NO_ADEQUATE_CARE_SERVICES = 4;            // Keine ausreichenden Betreuungsdienste
  NO_HOME_CARE = 5;                         // Keine ausreichende Hauskrankenpflege
}

// 31 Veränderungen persönliche Situation
enum PersonalChange {
  UNDEFINED_PERSONALCHANGE = 0;
  OWN_DESIRE_PC = 1;                         // Eigener Wunsch
  LOSS_MAIN_ATTENDANCE = 2;                  // Ausfall der Hauptbetreuungsperson
  INCREASED_ASSITANCE_NEED = 3;              // Erhöhter Betreuungsbedarf
  NURSING_NEED_PHYSICAL = 4;                 // Gestiegener Pflegebedarf körperlich
  NURSING_NEED_MENTAL = 5;                   // Gestiegener Pflegebedarf psychisch
  NEGLECT_RISK = 6;                          // Verstärkte Verwahrlosungsgefahr
}

// 24 Inanspruchnahme anderer Dienste
enum Service {
  UNDEFINED_SERVICE = 0;
  HOME_CARE = 1;                             // Hauskrankenpflege
  MOBILE_CARE_SERVICE = 2;                   // Mobiler Hilfsdienst
  HOME_MEAL_SERVICE = 3;                     // Mahlzeitendienst
  MEDICAL_THERAPEUTIC_SERVICE = 4;           // Medizinisch-therapeutische Dienste
  PRIVATE_CARE_24_HOUR = 5;                  // Private bezahlte Pflege (24 Stunden Betreuung)
  PRIVATE_CARE_HOURLY = 6;                   // Private bezahlte Pflege (stundenweise)
}

// 54 Entlassung
enum DischargeReason {
  UNDEFINED_DISCHARGEREASON = 0;
  END_SHORT_TERM_CARE = 1;                   // Ende der Kurzzeitpflege
  INCREASED_NEED_FOR_CARE = 2;               // erhöhte Betreuungs/Pflegebedürftigkeit
  LOWER_NEED_FOR_CARE = 3;                   // geringere Betreuungs/Pflegebedürftigkeit
  OWN_DESIRE = 4;                            // eigener Wunsch
  OTHER_DR = 5;                              // sonstige
}

// 53 Entlassung wohin
enum DischargeLocation {
  UNDEFINED_DISCHARGELOCATION = 0;
  HOME_LIVING_ALONE = 1;                       // nach Hause lebend alleine
  HOME_LIVING_NOT_ALONE = 2;                   // nach Hause lebend nicht alleine
  AMBULATORY_SUPERVISED_FLAT = 3;              // ambulant betreute (Senioren/Wohnung)
  SUPERVISED_FLAT = 4;                         // betreute Wohngemeinschaften
  NURSING_HOME = 5;                            // Pflegeheim nach Pflegeheimgesetz
  OTHER_ATTENDED_HOUSING = 6;                  // Sonstige betreute Wohnform
  OTHER_DL = 7;                                // Sonstige
  NO_DISCHARGELOCATION = 8;                    // keine Angabe
}

// 51 Abgang Art
enum LeavingReason {
  UNDEFINED_LR = 0;
  DECEASED_LR = 1;                             // verstorben
  DISCHARGE_LR = 2;                            // Entlassung
}

// 52 Sterbefall
enum DeathLocation {
  UNDEFINED_DL = 0;
  DEATH_NURSING_HOME_DL = 1;                   // Pflegeheim
  DEATH_HOSPITAL_DL = 2;                       // Krankenhaus
}

// 21 Verwandtschaftsverhältnis Hauptbetreuungspers.
enum MainAttendanceRelation {
  UNDEFINED_MR = 0;
  CHILD_MR = 1;                                // Kind/Schwiegerkind          
  RELATED_PERSON_MR = 2;                       // andere verwandte Person     
  UNRELATED_PERSON_MR = 3;                     // nicht verwandte Person      
  NO_MAIN_CARER_MR = 4;                        // keine Hauptbetreuungsperson 
  NO_MAINATTENDANCERELATION_MR = 5;            // keine Angabe
}

// 22 Räumliche Nähe Hauptbetreuungsperson
enum MainAttendanceCloseness {
  UNDEFINED_MC = 0;
  SAME_FLAT_MC = 1;                            // in der gleichen Wohnung
  SAME_HOUSE_OTHER_FLAT_MC = 2;                // im gleichen Haus aber in einer anderen Wohnung
  UP_TO_30_MIN_MC = 3;                         // bis zu 30 Minuten
  OVER_TO_30_MIN_MC = 4;                       // über 30 Minuten
  NO_MAINATTENDANCE_MC = 5;                    // keine Hauptbetreuungsperson
  NO_MAINATTENDANCECLOSENESS_MC = 6;           // keine Angabe
}


// Wohnform vor der Aufnahme
enum AdmissionLocation {
  UNDEFINED_AL = 0;
  HOME_LIVING_ALONE_AL = 1;                    // zu Hause lebend alleine
  HOME_LIVING_NOT_ALONE_AL = 2;                // zu Hause lebend nicht alleine
  AMBULATORY_SUPERVISED_FLAT_AL = 3;           // ambulant betreute (Senioren/Wohnung)
  SUPERVISED_FLAT_AL = 4;                      // betreute Wohngemeinschaften
  NURSING_HOME_AL = 5;                         // Pflegeheim nach Pflegeheimgesetz
  OTHER_ATTENDED_HOUSING_AL = 6;               // Sonstige betreute Wohnform
  OTHER_AL = 7;                                // Sonstige
  NO_DISCHARGELOCATION_AL = 8;                 // keine Angabe
}

// Diagnosegruppen
// Beschreibung in diagnosisgroups.csv
enum DiagnosisGroup { 
    UNDEFINED_DG = 0;
}

// Geschlecht, nach neuer Definition
enum Gender {
  UNDEFINED_GE = 0;
  MALE_GE = 1;
  FEMALE_GE = 2;
  DIVERS_GE = 3;
  INTER_GE = 4;
  OPEN_GE = 5;
}


// Finanzierung
enum Finance {
  UNDEFINED_FI = 0;
  SELF_FI = 1;                       // Selbst/Angehörige 100 %
  SOCIAL_ASSISTANCE_FI = 2;          // Mindestsicherung
  SOCIAL_ASSISTANCE_CLAIM_FI = 3;    // Mindestsicherungsantrag in Bearbeitung
}


// 05 Bezieht Pflegegeld
// Werte aus Bestand (xp_IGK_2002_GNV.mdb, Tabelle TB_Doku, TB_Doku_Gruppe)
enum CareAllowance {
  UNDEFINED_ALLOWANCE = 0;
  L1 = 1;
  L2 = 2;
  L3 = 3;
  L4 = 4;
  L5 = 5;
  L6 = 6;
  L7 = 7;	
  ANY = 9;              // Pflegegeld ja, Stufe unbekannt
  UNKNOWN = 88;         // unbekannt ob ja oder nein
  NONE = 99;            // Keine Pflegegeld
}

// 06 Einstufung nach Pflegegeld Gesetz
// Pflegestufe ARGE
// Werte aus Bestand (xp_IGK_2002_GNV.mdb, Tabelle TB_Doku, TB_Doku_Gruppe)
enum CareAllowanceArge {
  UNDEFINED_ALLOWANCE_AR = 0;
  L0_AR = 1;
  L1_AR = 2;
  L2_AR = 3;
  L3_AR = 4;
  L4_AR = 5;
  L5_AR = 6;
  L6_AR = 7;
  L7_AR = 8;	
}


// 41 Aufnahmeart
enum AdmissionType {
  UNDEFINED_AT = 0;
  CONTINUOUS_AT = 1;                    // Daueraufnahme
  HOLIDAY_AT = 2;                       // Urlaub von der Pflege
  TRANSITIONAL_AT = 3;                  // Übergangspflege
  COVID19_RESPITE_AT = 4;               // COVID-19 Entlastungspflege
  GERIATRIC_REMOBILIZATION_AT = 5;      // Geriatrische Remobilisation
  CARE_TRANSITION_AT = 6;               // Überleitungspflege
}
